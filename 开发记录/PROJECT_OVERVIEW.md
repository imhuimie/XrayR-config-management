# ğŸ¯ XrayR é…ç½®ç”Ÿæˆå™¨ - é¡¹ç›®æ¦‚è§ˆ

## ğŸ“Š é¡¹ç›®ä¿¡æ¯

- **é¡¹ç›®åç§°**: XrayR é…ç½®ç”Ÿæˆå™¨
- **ç‰ˆæœ¬**: 1.0.0
- **ç±»å‹**: Web åº”ç”¨ï¼ˆå‰åç«¯åˆ†ç¦»ï¼‰
- **ç›®æ ‡**: ç®€åŒ– XrayR é…ç½®æ–‡ä»¶çš„ç”Ÿæˆå’Œç®¡ç†

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           å‰ç«¯ (React + Vite)            â”‚
â”‚  - ç”¨æˆ·ç•Œé¢                              â”‚
â”‚  - è‡ªå®šä¹‰ Hooks                          â”‚
â”‚  - é€šç”¨ç»„ä»¶                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ HTTP/REST API
               â”‚ (Axios)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        åç«¯ (Node.js + Express)         â”‚
â”‚  - API è·¯ç”±                              â”‚
â”‚  - JWT è®¤è¯                              â”‚
â”‚  - CRUD å·¥å‚å‡½æ•°                         â”‚
â”‚  - é…ç½®ç”Ÿæˆ                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æ•°æ®å­˜å‚¨ (JSON æ–‡ä»¶)             â”‚
â”‚  - panels.json (é¢æ¿æ•°æ®)                â”‚
â”‚  - serverGroups.json (åˆ†ç»„æ•°æ®)          â”‚
â”‚  - servers.json (æœåŠ¡å™¨æ•°æ®)             â”‚
â”‚  - nodes.json (èŠ‚ç‚¹æ•°æ®)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç›®å½•ç»“æ„

```
xrayr-config-generator/
â”‚
â”œâ”€â”€ ğŸ“ server/                    # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ index.js                 # æœåŠ¡å…¥å£
â”‚   â”œâ”€â”€ ğŸ“ routes/               # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ auth.js             # è®¤è¯ API
â”‚   â”‚   â”œâ”€â”€ panels.js           # é¢æ¿ç®¡ç† API
â”‚   â”‚   â”œâ”€â”€ serverGroups.js     # åˆ†ç»„ç®¡ç† API
â”‚   â”‚   â”œâ”€â”€ servers.js          # æœåŠ¡å™¨ç®¡ç† API
â”‚   â”‚   â”œâ”€â”€ nodes.js            # èŠ‚ç‚¹ç®¡ç† API
â”‚   â”‚   â”œâ”€â”€ config.js           # é…ç½®ç”Ÿæˆ API
â”‚   â”‚   â”œâ”€â”€ ssh.js              # SSH æ“ä½œ API
â”‚   â”‚   â”œâ”€â”€ batch.js            # æ‰¹é‡æ“ä½œ API
â”‚   â”‚   â””â”€â”€ settings.js         # ç³»ç»Ÿè®¾ç½® API
â”‚   â”œâ”€â”€ ğŸ“ middleware/          # ä¸­é—´ä»¶
â”‚   â”‚   â””â”€â”€ auth.js             # JWT è®¤è¯ä¸­é—´ä»¶
â”‚   â””â”€â”€ ğŸ“ utils/               # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ dataStore.js        # æ•°æ®å­˜å‚¨å·¥å…·ï¼ˆå·¥å‚æ¨¡å¼ï¼‰
â”‚       â”œâ”€â”€ crudFactory.js      # CRUD è·¯ç”±å·¥å‚å‡½æ•°
â”‚       â””â”€â”€ validator.js        # è¾“å…¥éªŒè¯å·¥å…·ï¼ˆå®‰å…¨æ¨¡å—ï¼‰
â”‚
â”œâ”€â”€ ğŸ“ client/                   # å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ index.html              # HTML æ¨¡æ¿
â”‚   â”œâ”€â”€ vite.config.js          # Vite é…ç½®
â”‚   â”œâ”€â”€ package.json            # å‰ç«¯ä¾èµ–
â”‚   â””â”€â”€ ğŸ“ src/
â”‚       â”œâ”€â”€ main.jsx            # åº”ç”¨å…¥å£
â”‚       â”œâ”€â”€ App.jsx             # æ ¹ç»„ä»¶
â”‚       â”œâ”€â”€ index.css           # å…¨å±€æ ·å¼ï¼ˆCSS å˜é‡ + BEMï¼‰
â”‚       â”œâ”€â”€ ğŸ“ pages/           # é¡µé¢ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ Login.jsx       # ç™»å½•é¡µ
â”‚       â”‚   â”œâ”€â”€ Dashboard.jsx   # ä¸»æ§åˆ¶å°
â”‚       â”‚   â””â”€â”€ BatchManagement.jsx # æ‰¹é‡ç®¡ç†
â”‚       â”œâ”€â”€ ğŸ“ components/      # UI ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ ListCard.jsx    # é€šç”¨åˆ—è¡¨å¡ç‰‡ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ PanelList.jsx   # é¢æ¿åˆ—è¡¨
â”‚       â”‚   â”œâ”€â”€ ServerGroupList.jsx # åˆ†ç»„åˆ—è¡¨
â”‚       â”‚   â”œâ”€â”€ ServerList.jsx  # æœåŠ¡å™¨åˆ—è¡¨
â”‚       â”‚   â”œâ”€â”€ NodeList.jsx    # èŠ‚ç‚¹åˆ—è¡¨
â”‚       â”‚   â”œâ”€â”€ PanelModal.jsx  # é¢æ¿ç¼–è¾‘å¼¹çª—
â”‚       â”‚   â”œâ”€â”€ ServerGroupModal.jsx # åˆ†ç»„ç¼–è¾‘å¼¹çª—
â”‚       â”‚   â”œâ”€â”€ ServerModal.jsx # æœåŠ¡å™¨ç¼–è¾‘å¼¹çª—
â”‚       â”‚   â”œâ”€â”€ NodeModal.jsx   # èŠ‚ç‚¹ç¼–è¾‘å¼¹çª—
â”‚       â”‚   â”œâ”€â”€ ConfigViewer.jsx # é…ç½®æŸ¥çœ‹å™¨
â”‚       â”‚   â”œâ”€â”€ SSHModal.jsx    # SSH è¿æ¥å¼¹çª—
â”‚       â”‚   â”œâ”€â”€ SettingsModal.jsx # ç³»ç»Ÿè®¾ç½®å¼¹çª—
â”‚       â”‚   â”œâ”€â”€ ImportNodesModal.jsx # å¯¼å…¥èŠ‚ç‚¹å¼¹çª—
â”‚       â”‚   â”œâ”€â”€ ConfirmDialog.jsx # ç¡®è®¤å¯¹è¯æ¡†
â”‚       â”‚   â””â”€â”€ Toast.jsx       # æ¶ˆæ¯æç¤º
â”‚       â”œâ”€â”€ ğŸ“ hooks/           # è‡ªå®šä¹‰ Hooks
â”‚       â”‚   â”œâ”€â”€ index.js        # Hooks ç»Ÿä¸€å¯¼å‡º
â”‚       â”‚   â”œâ”€â”€ useToast.js     # Toast é€šçŸ¥ç®¡ç†
â”‚       â”‚   â”œâ”€â”€ useConfirmDialog.js # ç¡®è®¤å¯¹è¯æ¡†ç®¡ç†
â”‚       â”‚   â”œâ”€â”€ useCrudModal.js # CRUD æ¨¡æ€æ¡†çŠ¶æ€ç®¡ç†
â”‚       â”‚   â””â”€â”€ useApiData.js   # API æ•°æ®åŠ è½½
â”‚       â”œâ”€â”€ ğŸ“ utils/           # å·¥å…·å‡½æ•°
â”‚       â”‚   â””â”€â”€ api.js          # API è¯·æ±‚å°è£…
â”‚       â””â”€â”€ ğŸ“ styles/          # æ ·å¼æ–‡ä»¶
â”‚           â”œâ”€â”€ BatchManagement.css
â”‚           â”œâ”€â”€ ConfirmDialog.css
â”‚           â””â”€â”€ Toast.css
â”‚
â”œâ”€â”€ ğŸ“ data/                     # æ•°æ®å­˜å‚¨ç›®å½•ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
â”‚   â”œâ”€â”€ panels.json             # é¢æ¿æ•°æ®
â”‚   â”œâ”€â”€ serverGroups.json       # åˆ†ç»„æ•°æ®
â”‚   â”œâ”€â”€ servers.json            # æœåŠ¡å™¨æ•°æ®
â”‚   â”œâ”€â”€ nodes.json              # èŠ‚ç‚¹æ•°æ®
â”‚   â””â”€â”€ settings.json           # ç³»ç»Ÿè®¾ç½®
â”‚
â”œâ”€â”€ ğŸ“ SUMMARY/                  # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ ğŸ“ å¼€å‘è®°å½•/                  # å¼€å‘æ–‡æ¡£
â”œâ”€â”€ ğŸ“„ .env                      # ç¯å¢ƒå˜é‡é…ç½®
â”œâ”€â”€ ğŸ“„ .env.example             # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ ğŸ“„ .gitignore               # Git å¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ ğŸ“„ package.json             # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ ğŸ“„ README.md                # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ ğŸ“„ CLAUDE.md                # AI å¼€å‘æŒ‡å—
â”œâ”€â”€ ğŸš€ start.bat                # Windows å¯åŠ¨è„šæœ¬
â””â”€â”€ ğŸ“¦ install.bat              # Windows å®‰è£…è„šæœ¬
```

## ğŸ”‘ æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### 1. è®¤è¯æ¨¡å— (Authentication)

**æ–‡ä»¶**: `server/routes/auth.js`, `server/middleware/auth.js`

**åŠŸèƒ½**:
- å¯†ç ç™»å½•éªŒè¯
- JWT Token ç”Ÿæˆå’ŒéªŒè¯
- è¯·æ±‚æ‹¦æˆªå’Œè®¤è¯

**å®‰å…¨ç‰¹æ€§**:
- bcryptjs å¯†ç åŠ å¯†
- JWT Token æœ‰æ•ˆæœŸæ§åˆ¶ï¼ˆ24å°æ—¶ï¼‰
- è‡ªåŠ¨ Token åˆ·æ–°æœºåˆ¶

### 2. é¢æ¿ç®¡ç†æ¨¡å— (Panel Management)

**æ–‡ä»¶**: `server/routes/panels.js`, `client/src/components/PanelList.jsx`

**åŠŸèƒ½**:
- åˆ›å»ºé¢æ¿ï¼ˆåç§°ã€åŸŸåã€API Keyï¼‰
- ç¼–è¾‘é¢æ¿ä¿¡æ¯
- åˆ é™¤é¢æ¿
- æŸ¥çœ‹é¢æ¿åˆ—è¡¨
- é€‰æ‹©é¢æ¿

### 3. èŠ‚ç‚¹ç®¡ç†æ¨¡å— (Node Management)

**æ–‡ä»¶**: `server/routes/nodes.js`, `client/src/components/NodeList.jsx`

**åŠŸèƒ½**:
- åˆ›å»ºèŠ‚ç‚¹é…ç½®
- ç¼–è¾‘èŠ‚ç‚¹ä¿¡æ¯
- åˆ é™¤èŠ‚ç‚¹
- æŒ‰æœåŠ¡å™¨ç­›é€‰èŠ‚ç‚¹
- æ”¯æŒå¤šç§åè®®ï¼ˆVlessã€Vmessã€Shadowsocksã€Trojanï¼‰
- YAML é…ç½®å¯¼å…¥

### 4. é…ç½®ç”Ÿæˆæ¨¡å— (Config Generation)

**æ–‡ä»¶**: `server/routes/config.js`

**åŠŸèƒ½**:
- ç”Ÿæˆå•èŠ‚ç‚¹é…ç½®
- ç”ŸæˆæœåŠ¡å™¨æ‰€æœ‰èŠ‚ç‚¹é…ç½®
- ç”Ÿæˆå…¨å±€é…ç½®
- YAML æ ¼å¼è¾“å‡º
- ä¸€é”®å¤åˆ¶åŠŸèƒ½

## ğŸ¨ å‰ç«¯æ¶æ„ä¼˜åŒ–

### è‡ªå®šä¹‰ Hooks

é¡¹ç›®ä½¿ç”¨è‡ªå®šä¹‰ Hooks ç®€åŒ–çŠ¶æ€ç®¡ç†ï¼š

```javascript
// useToast - Toast é€šçŸ¥ç®¡ç†
const { toast, showToast, hideToast } = useToast();

// useConfirmDialog - ç¡®è®¤å¯¹è¯æ¡†ç®¡ç†
const { showConfirm, confirmDelete } = useConfirmDialog();

// useCrudModal - CRUD æ¨¡æ€æ¡†çŠ¶æ€ç®¡ç†
const panelModal = useCrudModal();
panelModal.openForCreate();
panelModal.openForEdit(item);
panelModal.close();

// useApiData - API æ•°æ®åŠ è½½
const { data, load, create, update, remove } = useApiData('/api/panels');
```

### é€šç”¨ç»„ä»¶

**ListCard** - ç»Ÿä¸€åˆ—è¡¨å±•ç¤ºï¼š

```jsx
<ListCard
  title="é¢æ¿åˆ—è¡¨"
  icon="ğŸ“‹"
  items={panels}
  selectedItem={selectedPanel}
  onSelect={setSelectedPanel}
  onAdd={handleAdd}
  renderContent={(item) => <div>{item.name}</div>}
  renderActions={(item) => <ActionButton>ç¼–è¾‘</ActionButton>}
/>
```

### CSS è®¾è®¡ç³»ç»Ÿ

ä½¿ç”¨ CSS å˜é‡å®šä¹‰è®¾è®¡ä»¤ç‰Œï¼š

```css
:root {
  --color-primary: #667eea;
  --color-success: #48bb78;
  --color-danger: #f56565;
  --spacing-md: 12px;
  --radius-md: 8px;
}
```

ä½¿ç”¨ BEM å‘½åè§„èŒƒï¼š

```css
.list-card__header { }
.list-card__title { }
.list-item--selected { }
```

## ğŸ” å®‰å…¨æœºåˆ¶

### 1. HTTP å®‰å…¨ (v1.1.0 æ–°å¢)
- âœ… Helmet å®‰å…¨å“åº”å¤´
- âœ… CORS é…ç½®ï¼ˆå¯é™åˆ¶æ¥æºï¼‰
- âœ… è¯·æ±‚ä½“å¤§å°é™åˆ¶ï¼ˆ1MBï¼‰
- âœ… å…¨å±€é€Ÿç‡é™åˆ¶ï¼ˆ1000æ¬¡/15åˆ†é’Ÿï¼‰

### 2. è®¤è¯å®‰å…¨
- âœ… å¯†ç  bcrypt åŠ å¯†å­˜å‚¨ï¼ˆæˆæœ¬å› å­ 12ï¼‰
- âœ… JWT Token è®¤è¯ï¼ˆ24å°æ—¶è¿‡æœŸï¼‰
- âœ… Token è¿‡æœŸè‡ªåŠ¨è·³è½¬
- âœ… è¯·æ±‚æ‹¦æˆªå™¨ç»Ÿä¸€å¤„ç†
- âœ… ç™»å½•é€Ÿç‡é™åˆ¶ï¼ˆ5æ¬¡/15åˆ†é’Ÿï¼‰
- âœ… ç™»å½•å¤±è´¥å»¶è¿Ÿå“åº”ï¼ˆé˜²æ—¶åºæ”»å‡»ï¼‰

### 3. è¾“å…¥éªŒè¯ (v1.1.0 æ–°å¢)
- âœ… è·¯å¾„éå†æ”»å‡»é˜²æŠ¤
- âœ… å‘½ä»¤æ³¨å…¥æ£€æµ‹
- âœ… æœåŠ¡å™¨åœ°å€æ ¼å¼éªŒè¯
- âœ… ID æ ¼å¼éªŒè¯
- âœ… URL æ ¼å¼éªŒè¯
- âœ… å­—ç¬¦ä¸²é•¿åº¦é™åˆ¶

### 4. æ•°æ®å®‰å…¨
- âœ… æœ¬åœ°æ–‡ä»¶å­˜å‚¨
- âœ… æ•°æ®éªŒè¯
- âœ… é”™è¯¯å¤„ç†
- âœ… æ•æ„Ÿä¿¡æ¯ä¸æš´éœ²

## ğŸ“¡ API æ¥å£æ–‡æ¡£

### è®¤è¯æ¥å£

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | è®¤è¯ |
|------|------|------|------|
| POST | /api/auth/login | ç™»å½• | âŒ |
| POST | /api/auth/verify | éªŒè¯Token | âŒ |

### é¢æ¿æ¥å£

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | è®¤è¯ |
|------|------|------|------|
| GET | /api/panels | è·å–æ‰€æœ‰é¢æ¿ | âœ… |
| POST | /api/panels | åˆ›å»ºé¢æ¿ | âœ… |
| PUT | /api/panels/:id | æ›´æ–°é¢æ¿ | âœ… |
| DELETE | /api/panels/:id | åˆ é™¤é¢æ¿ | âœ… |

### èŠ‚ç‚¹æ¥å£

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | è®¤è¯ |
|------|------|------|------|
| GET | /api/nodes | è·å–æ‰€æœ‰èŠ‚ç‚¹ | âœ… |
| GET | /api/nodes/server/:serverId | è·å–æœåŠ¡å™¨èŠ‚ç‚¹ | âœ… |
| POST | /api/nodes | åˆ›å»ºèŠ‚ç‚¹ | âœ… |
| PUT | /api/nodes/:id | æ›´æ–°èŠ‚ç‚¹ | âœ… |
| DELETE | /api/nodes/:id | åˆ é™¤èŠ‚ç‚¹ | âœ… |
| POST | /api/nodes/import | å¯¼å…¥èŠ‚ç‚¹ | âœ… |

### é…ç½®æ¥å£

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | è®¤è¯ |
|------|------|------|------|
| GET | /api/config/server/:serverId | è·å–æœåŠ¡å™¨é…ç½® | âœ… |

## ğŸš€ éƒ¨ç½²æ–¹æ¡ˆ

### å¼€å‘ç¯å¢ƒ
```bash
npm run dev
```
- åç«¯: http://localhost:61145
- å‰ç«¯: http://localhost:61146

### ç”Ÿäº§ç¯å¢ƒ

#### æ–¹æ¡ˆä¸€: å•æœåŠ¡å™¨éƒ¨ç½²
```bash
npm run build
npm start
```

#### æ–¹æ¡ˆäºŒ: Nginx åå‘ä»£ç†
```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://localhost:61146;
    }

    location /api {
        proxy_pass http://localhost:61145;
    }
}
```

## ğŸ“ å¼€å‘è§„èŒƒ

### ä»£ç é£æ ¼
- ES6+ è¯­æ³•
- å‡½æ•°å¼ç»„ä»¶ï¼ˆReactï¼‰
- async/await å¼‚æ­¥å¤„ç†
- æ¨¡å—åŒ–è®¾è®¡

### å‘½åè§„èŒƒ
- ç»„ä»¶: PascalCase
- å‡½æ•°: camelCase
- å¸¸é‡: UPPER_CASE
- CSS ç±»: BEM å‘½å

### è®¾è®¡åŸåˆ™
- **DRY**: ä½¿ç”¨å·¥å‚å‡½æ•°å’Œé€šç”¨ç»„ä»¶æ¶ˆé™¤é‡å¤
- **KISS**: ä¿æŒç®€å•ï¼Œé¿å…è¿‡åº¦è®¾è®¡
- **å•ä¸€èŒè´£**: æ¯ä¸ªæ¨¡å—åªåšä¸€ä»¶äº‹

## ğŸ“„ è®¸å¯è¯

MIT License - è‡ªç”±ä½¿ç”¨å’Œä¿®æ”¹

---

**æœ€åæ›´æ–°**: 2025-12-07
**ç‰ˆæœ¬**: 1.1.0 (å®‰å…¨å¢å¼ºç‰ˆ)
**ç»´æŠ¤è€…**: XrayR é…ç½®ç”Ÿæˆå™¨å›¢é˜Ÿ
