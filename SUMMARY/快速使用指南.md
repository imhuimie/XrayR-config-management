# XrayR 配置生成器 - 快速使用指南

## 🚀 5分钟快速上手

### 第一步: 安装和启动

1. **运行安装脚本**
   ```cmd
   install.bat
   ```

2. **启动项目**

   **方式一：一键启动（推荐）**
   ```cmd
   start.bat
   ```

   **方式二：使用 npm**
   ```cmd
   npm run dev
   ```

   **方式三：分别启动**
   ```cmd
   # 终端1：启动后端
   start-server.bat

   # 终端2：启动前端
   start-client.bat
   ```

3. **打开浏览器**
   访问: http://localhost:61146

4. **登录系统**
   - 默认密码: `admin123456`
   - ⚠️ **生产环境请立即修改密码**

---

## 📝 基础使用流程

### 1️⃣ 创建面板

1. 点击 **"➕ 新建面板"** 按钮
2. 填写面板信息:
   - **面板名称**: 例如 "主面板"
   - **面板域名**: 例如 "https://panel.example.com"
   - **API Key**: 从面板后台获取
3. 点击 **"保存"**

### 2️⃣ 创建服务器分组

1. 选择刚创建的面板
2. 点击 **"➕ 新建分组"** 按钮
3. 填写分组信息:
   - **分组名称**: 例如 "香港节点"
   - **描述**: 例如 "香港 CN2 GIA 节点"
4. 点击 **"保存"**

### 3️⃣ 添加服务器

1. 选择服务器分组
2. 点击 **"➕ 新建服务器"** 按钮
3. 填写服务器信息:
   - **服务器名称**: 例如 "HK-01"
   - **服务器地址**: 例如 "hk01.example.com:22"
   - **SSH 密钥/密码**: 输入 SSH 密码或私钥
   - **配置文件路径**: 例如 "/etc/XrayR/config.yml"
   - **部署后命令**: 例如 "systemctl restart XrayR"
4. 点击 **"保存"**

### 4️⃣ 添加节点

1. 选择服务器
2. 点击 **"➕ 新建节点"** 按钮
3. 选择节点类型 (Shadowsocks/V2ray/Trojan)
4. 填写节点信息:
   - **节点 ID**: 从面板获取
   - **节点类型**: 选择对应类型
   - **传输协议**: 根据需要选择
   - 其他参数根据实际情况填写
5. 点击 **"保存"**

### 5️⃣ 生成配置

1. 选择节点
2. 点击 **"📄 生成配置"** 按钮
3. 在弹出的窗口中:
   - 预览配置内容
   - 点击 **"📋 复制配置"** 复制到剪贴板
   - 或点击 **"📤 上传到服务器"** 直接上传

### 6️⃣ SSH 上传配置

1. 点击服务器的 **"🔗 SSH"** 按钮
2. 在 SSH 弹窗中:
   - 查看 SSH 连接信息
   - 点击 **"🧪 测试连接"** 测试 SSH 连接
   - 点击 **"📤 上传配置文件"** 上传配置
3. 上传成功后会自动执行部署命令

---

## 🎯 高级功能

### 批量管理

#### 批量上传文件

1. 点击 **"📦 批量管理"** 按钮
2. 选择服务器分组
3. 勾选要操作的服务器
4. 切换到 **"📤 批量上传文件"** 标签
5. 输入上传目录: `/etc/XrayR/`
6. 选择文件 (支持多选):
   - 按住 Ctrl 选择多个文件
   - 或拖拽文件到选择框
7. 点击 **"🚀 开始上传"**
8. 在日志面板查看上传进度

#### 批量执行命令

1. 在批量管理页面
2. 选择服务器
3. 切换到 **"⚡ 批量执行命令"** 标签
4. 输入命令: `systemctl restart XrayR`
5. 点击 **"⚡ 开始执行"** 或按 Enter
6. 在日志面板查看执行结果

### 导入节点配置

1. 准备 YAML 配置文件
2. 点击 **"📥 导入节点"** 按钮
3. 选择 YAML 文件
4. 系统会自动解析并创建节点

### 系统设置

#### 修改密码

1. 点击 **"⚙️ 系统设置"** 按钮
2. 切换到 **"🔐 修改密码"** 标签
3. 输入:
   - 原密码
   - 新密码（至少 8 位，必须包含字母和数字）
   - 确认密码
4. 点击 **"保存设置"**
5. 系统会自动退出，使用新密码重新登录

> ⚠️ **安全提示**: 生产环境部署后请立即修改默认密码！

#### 配置 SSH 代理

1. 在系统设置中
2. 切换到 **"🌐 SSH 代理设置"** 标签
3. 勾选 **"启用 SSH 连接代理"**
4. 选择代理类型:
   - HTTP
   - SOCKS5
   - SOCKS4
5. 填写代理信息:
   - 代理地址: `127.0.0.1`
   - 代理端口: `7890` (Clash 默认)
   - 用户名/密码 (如需要)
6. 点击 **"保存设置"**

---

## 💡 使用技巧

### 1. 快速复制配置
- 生成配置后，直接点击 **"📋 复制配置"**
- 配置会自动复制到剪贴板
- 可以粘贴到任何地方

### 2. 测试 SSH 连接
- 在上传配置前，先点击 **"🧪 测试连接"**
- 确保 SSH 连接正常
- 避免上传失败

### 3. 使用代理
- 如果服务器在国外，建议配置代理
- 可以加快 SSH 连接速度
- 支持 Clash、V2rayN 等常见代理软件

### 4. 批量操作
- 批量上传可以同时上传多个文件
- 批量命令可以一次性操作多台服务器
- 节省大量时间

### 5. 数据备份
- 定期备份 `data/` 目录
- 包含所有配置数据
- 可以快速恢复

---

## 🔧 常见操作

### 编辑已有数据
- 点击列表项右侧的 **"✏️ 编辑"** 按钮
- 修改信息后点击 **"保存"**

### 删除数据
- 点击列表项右侧的 **"🗑️ 删除"** 按钮
- 确认删除操作
- ⚠️ 删除面板会同时删除下属所有数据

### 查看配置
- 选择节点后点击 **"📄 生成配置"**
- 可以预览完整的 YAML 配置
- 支持语法高亮

---

## ⚠️ 注意事项

### 1. 数据层级关系
```
面板 → 分组 → 服务器 → 节点
```
- 删除上层数据会删除所有下层数据
- 请谨慎操作

### 2. SSH 连接
- 确保服务器 SSH 端口开放
- 确保密码或密钥正确
- 如使用代理，确保代理正常运行

### 3. 配置文件路径
- 路径必须是绝对路径
- 例如: `/etc/XrayR/config.yml`
- 不存在的目录会自动创建

### 4. 部署命令
- 命令会在上传配置后自动执行
- 常用命令:
  - `systemctl restart XrayR`
  - `docker restart xrayr`
  - `supervisorctl restart xrayr`

---

## 🎨 界面说明

### 主界面布局
```
┌─────────────────────────────────────┐
│  [⚙️ 系统设置] [📦 批量管理] [🚪 退出] │
├─────────────────────────────────────┤
│  📁 面板列表                         │
│  📁 服务器分组                       │
│  🖥️ 服务器列表                       │
│  🌐 节点列表                         │
└─────────────────────────────────────┘
```

### 批量管理界面
```
┌──────────────┬──────────────────────┐
│ 📁 服务器分组 │  📤 批量上传文件      │
│ 🖥️ 服务器列表 │  ⚡ 批量执行命令      │
│              │                      │
│ ☑ 服务器1    │  ┌─────────────────┐ │
│ ☑ 服务器2    │  │  执行日志        │ │
│ ☐ 服务器3    │  │                 │ │
│              │  └─────────────────┘ │
└──────────────┴──────────────────────┘
```

---

## 📞 获取帮助

### 查看文档
- `SUMMARY/项目总结.md` - 完整项目文档
- `SUMMARY/Windows环境要求.md` - 环境配置说明

### 常见问题
- 端口被占用 → 修改配置文件中的端口
- 连接失败 → 检查网络和防火墙
- 上传失败 → 检查 SSH 配置和权限

---

---

## 🔒 生产环境安全配置

### 必须完成的安全设置

1. **修改 JWT 密钥**
   ```bash
   # 生成强随机密钥
   node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
   ```
   将生成的密钥填入 `.env` 文件的 `JWT_SECRET`

2. **修改管理员密码**
   - 登录后在系统设置中修改
   - 要求：至少 8 位，包含字母和数字

3. **配置 CORS（可选）**
   ```env
   CORS_ORIGIN=https://your-domain.com
   ```

4. **使用 HTTPS**
   - 配置 Nginx 反向代理
   - 启用 SSL/TLS 证书

详细安全配置请参考: `开发记录/安全增强说明.md`

---

**祝使用愉快！** 🎉

**最后更新**: 2025-12-07
**版本**: 1.1.0

